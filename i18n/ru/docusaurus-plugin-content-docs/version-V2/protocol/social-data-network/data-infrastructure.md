---
id: data-infrastructure
title: Инфраструктура данных
slug: /protocol/social-data-network/data-infrastructure
sidebar_label: Инфраструктура данных
sidebar_position: 1
description: Инфраструктура данных
---

Разработчики, которые используют CyberConnect для хранения социальных данных пользователей, должны иметь возможность безопасно полагаться на протокол для записи и обновления миллионов записей. В то же время разработчики должны быть уверены, что CyberConnect не станет единственной точкой отказа для злоумышленников. Поэтому нам нужна достаточно децентрализованная система хранения данных, которая отличается производительностью и обеспечивает гарантии суверенитета, доступности и целостности данных.

## Суверенитет данных

Чтобы обеспечить суверенитет данных, каждая связь и контент в CyberConnect должны быть подписаны парой криптографических ключей, что означает, что только человек с закрытым ключом мог создать такую связь и контент. Этот механизм разработан таким образом, чтобы он был одновременно простым в использовании и перспективным.

Когда пользователь впервые взаимодействует с CyberConnect через децентрализованное приложение, он создает пару ключей на устройстве и публикует открытый ключ в сети социальных данных CyberConnect. Мы поддерживаем различные алгоритмы цифровой подписи с эллиптической кривой (ECDSA) для обеспечения совместимости. Когда пользователь инициирует действие, ранее сгенерированный закрытый ключ будет загружен из локальной среды для подписи сообщения.

В следующем разделе будет объяснено, как узлы в сети выполняют работу по хранению этих подписанных данных. Стоит отметить, что в то же время Social Data Network совместима с дизайном DID от Ceramic, что позволяет легко хранить некоторые данные на Ceramic.

### Профиль пользователя

У каждого пользователя должно быть выделенное пространство для хранения соответствующей информации о социальном профиле. В качестве отправной точки мы взяли схему BasicProfile от Ceramic и добавили схему CyberProfile, позволяющую пользователям добавлять произвольные блоки контента. Ниже приведена псевдосхема в Typescript. Все необработанные изображения для фона и аватара хранятся в IPFS или других децентрализованных хранилищах данных.

```js
type Profile = {
    /** Фоновое изображение профиля, хэш IPFS-адреса */
    backgroundPicture: string,
    /** Био, до 1,000 символов */
    bio: string,
    /** Блоки, относящиеся к профилю, упорядочены */
    blocks: Array<Block>,
    /** Отображаемое имя профиля, стандартное: 1-20 символов; только буквы, цифры и пробелы */
    displayName: string,
    /** Дескриптор профиля */
    handle: string,
    /** Изображение аватара профиля, хэш IPFS-адреса */
    profilePicture: string,
    /** Информация для подтверждения профиля в Twitter */
    twitterVerification: TwitterVerification,
};
```

### Идемпотентное доказательство связи и контента

Социальные платформы, такие как Twitter, имеют миллионы новых связей и сообщений, генерируемых пользователями каждый день. Следовательно, стандарт данных должен быть эффективным и в то же время удобным для работы, чтобы поддерживать масштабирование.

Возьмем в качестве примера данные о связи, довольно простым способом сделать это было бы поместить всех ваших подписчиков в список и добавить адрес в список, когда пользователь подписывается на кого-то нового, и удалить адрес из списка, когда происходит действие отмены подписки. Однако этот подход потребует, чтобы хранилище данных и вычислительный механизм обеспечивали гарантию ACID для работы в многопоточных сценариях, таких как отслеживание нескольких пользователей или отслеживание и отмена подписки за короткий промежуток времени. Кроме того, гарантия ACID обходится недешево в децентрализованной среде.

Поэтому мы используем идемпотентное доказательство для описания наиболее актуального состояния связей между любыми двумя адресами и контентом, созданным пользователями. Преимущество использования идемпотентности заключается в простом разрешении конфликтов без гарантии ACID. Вместо использования модели данных, подобной “списку подписчиков”, где каждый новый следующий адрес добавляется к тому же списку, мы описываем социальные связи как конечное желаемое состояние каждой отдельной пары адресов (подписаны они или нет) на эту временную метку.

Для любых двух адресов на операцию может существовать только одно состояние, например, Алиса может только либо следовать за Бобом, либо не следовать за ним. Подтверждение связи включает в себя следующие сведения о желаемом состоянии между отправителем и целевым адресом (подтверждение контента имеет аналогичную структуру):

```json
type Proof = {
  /** Название операции, например, Follow */
  name: string;
  /** Состояние операции, например, true или false для следования или нет */
  state: boolean;
  /** Адрес отправителя */
  from: string;
  /** Целевой адрес */
  to: string;
  /** Из какого dApp возникла эта связь */
  namespace: string;
  /** Из какой сети возникла эта связь */
  network: string;
  /** Отметка времени */
  timestamp: number;
}
```

Мы описываем эти стандартные данные только в формате необработанного объекта. Однако окончательное сообщение, отправляемое в сеть социальных данных CyberConnect, будет закодировано как с дайджестом сообщения, так и с подписью, подписанной владельцем. Мы оставляем этот процесс подписания общим, чтобы он был совместим с кодировкой IPLD от Ceramic с DAG-JOSE или с более простым форматом больших двоичных объектов JSON Blob.

## Целостность и доступность данных

Для децентрализованной сети передачи данных мы должны обеспечить доступность данных (чтобы данные не подвергались цензуре) и целостность данных (чтобы данные не могли быть изменены несанкционированным образом). Протокол CyberConnect использует гибридную модель для различных случаев использования данных в зависимости от частоты записи и объема данных.

Для модели данных профиля пользователя мы напрямую используем Ceramic в качестве хранилища данных, которое уже обеспечивает доступность данных благодаря своим файловым структурам, совместимым с IPFS, и целостность данных за счет привязки корня Меркла к обновлениям новых файлов в блокчейне. Поскольку данные профиля пользователя записываются реже, а количество существующих файлов линейно пропорционально существующей базе пользователей, Ceramic здесь является идеальным решением.

Для идемпотентного доказательства, поскольку пользователи коллективно создали бы миллионы записей на социальной платформе, было бы невозможно хранить все на Ceramic в его текущем масштабе, одновременно обеспечивая высокий уровень соглашения об уровне обслуживания (SLA) для разработчиков децентрализованных приложений.

Таким образом, мы разработали механизм для безопасной обработки записей и обновлений связей между пользователями, используя список, связанный с хэшем, и децентрализованное хранилище данных. Каждая пара адресов (для подтверждения связи) и операция будут создавать новый хэшированный список ссылок, называемый "журнал операций", при первой транзакции. Каждое обновление состояния (изменение с following на unfollowing) добавляло бы новый узел с новым состоянием в конец журнала операций. Каждое новое состояние хранится локально на центральном сервере до тех пор, пока логика пакетной загрузки не загрузит конец каждого журнала операций в децентрализованную систему хранения файлов, такую как Arweave или IPFS.

Каждый узел в этом журнале операций хранится локально на центральном сервере для кэширования и обслуживания быстрых запросов. Пользователи могут проверять целостность данных, получая последнее состояние связи между любыми двумя адресами, и просматривать список хэшированных ссылок, запрашивая предыдущий узел с центрального сервера. Мы предполагаем, что здесь используется доверенный центральный сервер, поскольку доступность данных требует, чтобы центральный узел отвечал на эти запросы данных. Мы считаем, что это достаточно децентрализованная и высокопроизводительная система.

![linkedlist](/img/v2/linkedlist.png)

## Конфиденциальность данных

Мы также постоянно проводим исследования по обеспечению сохраняющих конфиденциальность данных социальных сетей. Наше решение в протоколе CyberConnect, скорее всего, может представлять собой комбинацию следующих двух подходов.

### Шифрование данных

Пользователи должны иметь возможность контролировать доступ третьих лиц к своим социальным данным без необходимости отказываться от права собственности или раскрывать указанные данные кому-либо, кто не является их предполагаемым получателем. С другой стороны, сторонние разработчики должны иметь возможность расшифровывать эти данные при разумном соблюдении набора разрешений или потерять свой доступ, если они больше не соответствуют необходимым требованиям. Решение Lit Protocol со списками контроля доступа получило значительную поддержку в этом отношении, и команда CyberConnect многое узнала об их сильных и слабых сторонах.

### Zero Knowledge Proof

Доказательство с нулевым знанием, это метод, с помощью которого одна сторона (доказывающий) может доказать другой стороне (верификатору), что данное утверждение истинно, вообще не раскрывая никакой информации об указанном утверждении. В социальном контексте Боб должен быть в состоянии доказать стороннему социальному приложению, требующему доступа к списку его друзей, что он действительно связан с Алисой, не делясь никакой другой информацией о том, как, где, когда было установлено это соединение или что еще у них общего.
